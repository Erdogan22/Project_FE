{% extends "base.html" %}

{% block title %}Gestion des utilisateurs{% endblock %}

{% block content %}
<div class="container mt-5">
    <h3>Gestion des utilisateurs</h3>

    <table class="table table-bordered">
        <tr>
            <th>Nom</th>
            <th>Email</th>
            <th>Rôle</th>
            <th>Actions</th>
        </tr>

        <form method="GET" class="mb-3">
            <input name="q" value="{{ q }}" class="form-control"
                placeholder="Rechercher par email">
        </form>

        {% for user in users %}
        <tr>
            <td>{{ user.nom }} {{ user.prenom }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role }}</td>
            <td>
                {% if user.role != 'admin' %}
                <form method="POST" enctype="multipart/form-data"
                      action="{{ url_for('admin.delete_user', user_id=user.id) }}"
                      style="display:inline;"
                      onsubmit="return confirm('Supprimer cet utilisateur ?');">
                    
                    <button type="submit" class="btn btn-danger btn-sm">
                        Supprimer
                    </button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        <nav>
            {% if users.has_prev %}
            <a href="?page={{ users.prev_num }}&q={{ q }}">←</a>
            {% endif %}
            {% if users.has_next %}
            <a href="?page={{ users.next_num }}&q={{ q }}">→</a>
            {% endif %}
        </nav>
    </table>
</div>
{% endblock %}